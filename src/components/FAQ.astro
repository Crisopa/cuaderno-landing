---
const faqs = [
  {
    question: '¿Esto vale para la inspección?',
    answer: 'Sí. Los informes cumplen con el RD 1311/2012. Cuando venga el inspector, le enseñas el PDF y listo.',
  },
  {
    question: '¿Tengo que meter todas las parcelas a mano?',
    answer: 'Solo una vez. Añades provincia, municipio, polígono, parcela y recinto. Después solo seleccionas de la lista.',
  },
  {
    question: '¿Qué pasa cuando acaban los 30 días?',
    answer: 'Si no eliges un plan, tu cuenta pasa a solo lectura. No pierdes nada. Cuando quieras, activas un plan y sigues.',
  },
  {
    question: '¿Puedo cancelar cuando quiera?',
    answer: 'Sí. Sin permanencia. Cancelas y no se te vuelve a cobrar. Tus datos se guardan 6 meses por si vuelves.',
  },
  {
    question: '¿Funciona en el móvil?',
    answer: 'Sí. Funciona en cualquier navegador. No hace falta instalar nada. Puedes registrar un tratamiento desde la finca.',
  },
  {
    question: '¿Lo puede usar mi asesor?',
    answer: 'Sí. Con el plan Enterprise puedes tener hasta 5 usuarios. Ideal para asesores o cooperativas.',
  },
  {
    question: '¿Y si luego quiero exportar mis datos?',
    answer: 'Tus datos son tuyos. Puedes exportarlos en cualquier momento en PDF o Excel.',
  },
]
---

<section id="faq" class="py-20 sm:py-28 bg-gray-50">
  <div class="mx-auto max-w-3xl px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="text-center">
      <span class="inline-flex items-center rounded-full bg-primary-100 px-4 py-1 text-sm font-medium text-primary-800">
        Dudas
      </span>
      <h2 class="mt-4 text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">
        Preguntas frecuentes
      </h2>
    </div>

    <!-- FAQ Accordion -->
    <div class="mt-12 space-y-4">
      {faqs.map((faq, index) => (
        <div class="faq-item rounded-xl border border-gray-200 bg-white overflow-hidden">
          <button
            type="button"
            class="faq-button flex w-full items-center justify-between px-6 py-5 text-left"
            aria-expanded="false"
            aria-controls={`faq-content-${index}`}
          >
            <span class="text-base font-medium text-gray-900 pr-4">{faq.question}</span>
            <svg
              class="faq-icon h-5 w-5 flex-shrink-0 text-gray-500 transition-transform duration-200"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div
            id={`faq-content-${index}`}
            class="faq-content hidden px-6 pb-5"
          >
            <p class="text-gray-600 leading-relaxed">{faq.answer}</p>
          </div>
        </div>
      ))}
    </div>

    <!-- Contact CTA -->
    <div class="mt-12 text-center">
      <p class="text-gray-600">
        ¿Otra duda?
        <a
          href="mailto:hola@crisopa.es"
          class="ml-1 text-primary-700 hover:text-primary-800 font-medium"
        >
          Escríbenos
        </a>
      </p>
    </div>
  </div>
</section>

<script>
  const faqItems = document.querySelectorAll('.faq-item')

  faqItems.forEach(item => {
    const button = item.querySelector('.faq-button')
    const content = item.querySelector('.faq-content')
    const icon = item.querySelector('.faq-icon')

    button?.addEventListener('click', () => {
      const isExpanded = button.getAttribute('aria-expanded') === 'true'

      // Cerrar otros items
      faqItems.forEach(otherItem => {
        if (otherItem !== item) {
          const otherButton = otherItem.querySelector('.faq-button')
          const otherContent = otherItem.querySelector('.faq-content')
          const otherIcon = otherItem.querySelector('.faq-icon')

          otherButton?.setAttribute('aria-expanded', 'false')
          otherContent?.classList.add('hidden')
          otherIcon?.classList.remove('rotate-180')
        }
      })

      // Toggle current item
      button.setAttribute('aria-expanded', (!isExpanded).toString())
      content?.classList.toggle('hidden', isExpanded)
      icon?.classList.toggle('rotate-180', !isExpanded)
    })
  })
</script>
