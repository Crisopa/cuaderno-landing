---
const deadline = '2026-03-31T23:59:59'
---

<div id="promo-banner" class="relative bg-gradient-to-r from-accent-900 via-accent-800 to-accent-900 overflow-hidden">
  <!-- Shimmer effect -->
  <div class="absolute inset-0 bg-[linear-gradient(110deg,transparent_25%,rgba(255,255,255,0.06)_50%,transparent_75%)] bg-[length:250%_100%] animate-shimmer"></div>

  <a href="#precios" class="relative flex items-center justify-center gap-3 sm:gap-4 px-4 py-2 sm:py-2.5 group">
    <!-- Texto oferta -->
    <span class="text-xs sm:text-sm font-bold text-white">
      Oferta de lanzamiento
    </span>

    <span class="text-accent-400 hidden sm:inline">|</span>

    <!-- Countdown -->
    <span class="flex items-center gap-1.5 text-xs sm:text-sm font-mono font-bold text-accent-300" id="countdown" data-deadline={deadline}>
      <span class="inline-flex items-center justify-center bg-accent-950/60 rounded px-1.5 py-0.5 min-w-[2ch] text-white" id="cd-days">--</span>
      <span class="text-accent-500">d</span>
      <span class="inline-flex items-center justify-center bg-accent-950/60 rounded px-1.5 py-0.5 min-w-[2ch] text-white" id="cd-hours">--</span>
      <span class="text-accent-500">h</span>
      <span class="inline-flex items-center justify-center bg-accent-950/60 rounded px-1.5 py-0.5 min-w-[2ch] text-white" id="cd-mins">--</span>
      <span class="text-accent-500">m</span>
      <span class="inline-flex items-center justify-center bg-accent-950/60 rounded px-1.5 py-0.5 min-w-[2ch] text-white" id="cd-secs">--</span>
      <span class="text-accent-500">s</span>
    </span>

    <span class="text-accent-400 hidden sm:inline">|</span>

    <!-- CTA -->
    <span class="hidden sm:inline-flex items-center gap-1 text-xs sm:text-sm font-semibold text-accent-300 group-hover:text-white transition-colors">
      Hasta -37%
      <svg class="w-3.5 h-3.5 transition-transform group-hover:translate-x-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
        <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6" />
      </svg>
    </span>
  </a>
</div>

<script>
  function startCountdown() {
    const el = document.getElementById('countdown')
    if (!el) return

    const deadline = new Date(el.dataset.deadline!).getTime()
    const days = document.getElementById('cd-days')
    const hours = document.getElementById('cd-hours')
    const mins = document.getElementById('cd-mins')
    const secs = document.getElementById('cd-secs')

    function update() {
      const now = Date.now()
      const diff = Math.max(0, deadline - now)

      const d = Math.floor(diff / (1000 * 60 * 60 * 24))
      const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60))
      const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60))
      const s = Math.floor((diff % (1000 * 60)) / 1000)

      if (days) days.textContent = String(d).padStart(2, '0')
      if (hours) hours.textContent = String(h).padStart(2, '0')
      if (mins) mins.textContent = String(m).padStart(2, '0')
      if (secs) secs.textContent = String(s).padStart(2, '0')

      if (diff > 0) requestAnimationFrame(() => setTimeout(update, 1000))
    }

    update()
  }

  startCountdown()
  document.addEventListener('astro:page-load', startCountdown)
</script>
